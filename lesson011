1.1. Organizing Tabular Data in Python
1.1.1 When working with this sort of tabular data, it's important to organize row and columns following the principles of "tidy data."
What does that mean in the case of our dataset?

Each row corresponds to a single house in our dataset. We'll call each of these houses an observation.
Each column corresponds to a characteristic of each house. We'll call these features.
Each cell contains only one value.

1.1.2 list:
eg:house_0_list = [115910.26, 128, 4];house_0_list[0]=115910.26
#the first item in a list is always 0.

house_0_price_m2 = house_0_list[0]/ house_0_list[1]

1.1.3 append:
to add a new item at the end.
eg:house_0_list.append(house_0_price_m2)
then,house_0_list=[115910.26, 128, 4, 905.54890625]

liståµŒå¥—list:
houses_nested_list = [
    [115910.26, 128.0, 4.0],
    [48718.17, 210.0, 3.0],
    [28977.56, 58.0, 2.0],
    [36932.27, 79.0, 3.0],
    [83903.51, 111.0, 3.0],
]
listä¸ºlistä¸­çš„å…ƒç´ 

1.1.4 ç”¨forå¾ªç¯è®¡ç®—listå…ƒç´ æ„æˆçš„å‡½æ•°
eg:for house in houses_nested_list:
    price_m2 = house[0]/house[1]
    house.append(price_m2)
    
houses_nested_list
then,æ¯ä¸ªlistçš„æœ€åéƒ½ä¼šå¢åŠ ä¸€ä¸ªå…ƒç´ 

1.1.5 dictionaryï¼š
æ¯”èµ·listæœ‰keyå¯ä»¥çŸ¥é“valuesä»£è¡¨ä»€ä¹ˆ
eg:
house_0_dict = {
    "price_aprox_usd": 115910.26,
    "surface_covered_in_m2": 128,
    "rooms": 4,
}
output:
house_0_dict={'price_aprox_usd': 115910.26, 'surface_covered_in_m2': 128, 'rooms': 4}

1.1.7
Calculate:
eg:
house_0_dict["price_per_m2"] = house_0_dict["price_aprox_usd"]/house_0_dict["surface_covered_in_m2"]
then,
house_0_dict={'price_aprox_usd': 115910.26,
 'surface_covered_in_m2': 128,
 'rooms': 4,
 'price_per_m2': 905.54890625}
 
1.1.8 JSON:
JSON stands for Java Script Object Notation, and it's a text format for storing and transporting data.
JSON works by creating key-value pairs, where the key is data that can be represented by letters (called a string). 
JSON values can be strings, numbers, objects, arrays, boolean data, or null. 
JSON usually comes as a list of dictionaries.

eg:houses_rowwise is a dictionary
for house in houses_rowwise:
    house["price_per_m2"] = house["price_aprox_usd"]/house["surface_covered_in_m2"]
houses_rowwise
the step add "price_per_m2" and its value in the end of the dictionary.

1.1.9
calculate:åˆ©ç”¨forå¾ªç¯
#å»ºç©ºåˆ—è¡¨
house_prices = []
#å°†houses_rowwiseä¸­"price_aprox_usd"çš„å€¼éƒ½æ·»åŠ åˆ°house_pricesåˆ—è¡¨ä¸­
for house in houses_rowwise:
    house_prices.append(house["price_aprox_usd"])
#è®¡ç®—å¹³å‡æ•°ï¼Œsumæ±‚å’Œåˆ—è¡¨å…ƒç´ ï¼Œlenè®¡ç®—ä¸ªæ•°   
mean_house_price = sum(house_prices) / len(house_prices)

1.1.10
#è®¡ç®—dictionaryä¸­çš„list
eg:
houses_columnwise = {
    "price_aprox_usd": [115910.26, 48718.17, 28977.56, 36932.27, 83903.51],
    "surface_covered_in_m2": [128.0, 210.0, 58.0, 79.0, 111.0],
    "rooms": [4.0, 3.0, 2.0, 3.0, 3.0],
}

1.1.11
#æ±‚å¹³å‡æ•°
mean_house_price = sum(houses_columnwise["price_aprox_usd"])/len(houses_columnwise["price_aprox_usd"])

#åˆ©ç”¨forå¾ªç¯è®¡ç®—"price_per_m2"å¹¶æ·»åŠ åˆ°dictionaryä¸­
price = houses_columnwise["price_aprox_usd"]
area = houses_columnwise["surface_covered_in_m2"]
price_per_m2 = []
for p,a in zip(price,area):
    price_m2 = p/a
    price_per_m2.append(price_m2)
#æ·»åŠ æ–°column
houses_columnwise["price_per_m2"] = price_per_m2

1.1.12 DataFrames
a table tool in the data science libraries--pandas
eg:
#first,need to import
import pandas as pd
data = {
    "price_aprox_usd": [115910.26, 48718.17, 28977.56, 36932.27, 83903.51],
    "surface_covered_in_m2": [128.0, 210.0, 58.0, 79.0, 111.0],
    "rooms": [4.0, 3.0, 2.0, 3.0, 3.0],
}

df_houses = pd.DataFrame(data)


1.2 data wrangling with pandas
1.2.1 read csv file
eg:
df1 = pd.read_csv("data/mexico-real-estate-1.csv")
df2 = pd.read_csv("data/mexico-real-estate-2.csv")
df3 = pd.read_csv("data/mexico-real-estate-3.csv")

1.2.2 Inspect a DataFrame using the shape, info, and head in pandas.
df1.shape #æ˜¾ç¤ºæ•°æ®çš„è¡Œæ•°å’Œåˆ—æ•°(rows,columns)
df1.head() #æ˜¾ç¤ºdataframe table
df1.info() #æ˜¾ç¤ºæ•°æ®è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ¯åˆ—æ•°æ®ä¸ªæ•°ã€ç±»å‹ã€éç©ºå€¼ä¸ªæ•°

1.2.3
dropna #åˆ é™¤ç©ºå€¼
df1.dropna(inplace=True)
str.replace #åˆ é™¤å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦
astype #æ”¹å˜æ•°æ®ç±»å‹
df1["price_usd"] = (df1["price_usd"].str.replace("$","",regex=False).str.replace(",","").astype(float))

1.2.4 dropåˆ é™¤columns
df2.dropna(inplace=True) #åˆ é™¤ç©ºå€¼
df2["price_usd"] = (df2["price_mxn"]/19).round(2) #ç¾å…ƒå¢¨è¥¿å“¥å…ƒè½¬æ¢è®¡ç®—ï¼Œround(2)ä¿ç•™2ä½å°æ•°
df2.drop(columns=["price_mxn"],inplace=True) #åˆ é™¤["price_mxn"] columns

1.2.5 splitåˆ†å‰²åˆ—
eg:
df3[["lat","lon"]]=df3["lat-lon"].str.split(",",expand=True)
æ„ä¸ºå°†"lat-lon"åˆ—ä¸­ä»¥","è¿›è¡Œåˆ†å‰²æˆä¸¤åˆ—ï¼Œåˆ†åˆ«å‘½åä¸º"lat","lon"ã€‚

1.2.6 dropåˆ é™¤columns
df3.drop(columns=["place_with_parent_names","lat-lon"],inplace=True)

1.2.7 concatåˆå¹¶åˆ—è¡¨
df = pd.concat([df1,df2,df3])

1.2.8 ä¿å­˜ä¸ºæ–°çš„csvæ–‡ä»¶
df.to_csv("data/mexico-real-estate-clean.csv",index=False)

1.3 Exploratory Data Analysis
first,import
import matplotlib.pyplot as plt
import pandas as pd
import plotly.express as px

1.3.1 Read the CSV file
df = pd.read_csv("data/mexico-real-estate-clean.csv")

1.3.2 Add "lat" and "lon" to the code below
eg:
plotlyç»˜åˆ¶åœ°å›¾
fig = px.scatter_mapbox(
    df,  # Our DataFrame
    lat="lat",
    lon="lon",
    center={"lat": 19.43, "lon": -99.13},  # Map will be centered on Mexico City
    width=600,  # Width of map
    height=600,  # Height of map
    hover_data=["price_usd"],  # Display price when hovering mouse over house
)

fig.update_layout(mapbox_style="open-street-map")

fig.show()

1.3.3 value_counts()è®¡ç®—"state"columnçš„é¢‘æ¬¡
df["state"].value_counts().head()

1.3.4 describe æè¿°æ€§ç»Ÿè®¡
df[["area_m2","price_usd"]].describe()
å¯¹"area_m2","price_usd"ä¸¤åˆ—è¿›è¡Œæè¿°æ€§ç»Ÿè®¡
åŒ…æ‹¬countï¼Œmeanï¼Œstdï¼Œminï¼Œ25%ï¼Œ50%ï¼Œ75%ï¼Œmax	

1.3.5 Create a histogram ç»˜åˆ¶ç›´æ–¹å›¾
plt.hist(df['area_m2']) #ç”¨'area_m2'åˆ—çš„æ•°æ®
plt.xlabel("Area [sq meters]") #Xè½´å‘½å
plt.ylabel("Frequency"); #Yè½´å‘½å
#åœ¨ç»“å°¾æ·»åŠ  ; å¯ä»¥åˆ é™¤æè¿°æ€§ä¿¡æ¯

1.3.6 Create a horizontal boxplot ç»˜åˆ¶æ°´å¹³Kçº¿å›¾
plt.boxplot(df["area_m2"],vert=False) #vert=False æ„ä¸ºæ°´å¹³ï¼ŒTrueæˆ–è€…ä¸å†™åˆ™å›¾åƒä¸ºç«–ç›´å‹
plt.xlabel("Area [sq meters]")
plt.title("Distribution of Home Sizes");

1.4 Location or Size

1.4.1 groupbyåˆ›å»ºåºåˆ—
DataFrame.groupby(by=None, 
axis=0, 
level=None, 
as_index=True, 
sort=True, 
group_keys=_NoDefault.no_default, 
squeeze=_NoDefault.no_default, 
observed=False, 
dropna=True)

eg:
mean_price_by_state = df.groupby("state")["price_usd"].mean().sort_values(ascending=False)
è®¡ç®—æ¯ä¸ª"state"ä¸­"price_usd"çš„å‡å€¼
sort_values(ascending=False) #é™åºæ’åˆ—

1.4.2 åˆ›å»ºæŸ±çŠ¶å›¾
eg:
mean_price_by_state.plot(
    kind="bar",
    xlabel="State",
    ylabel="Mean Price [USD]",
    title="Mean House Price by State"
);

1.4.3 åˆ©ç”¨groupbyåˆ›å»ºçš„åºåˆ—åˆ›å»ºæŸ±çŠ¶å›¾
(
    df
    .groupby("state")
    ["price_per_m2"].mean()
    .sort_values(ascending=False)
    .plot(
        kind="bar",
        xlabel="State",
        ylabel="Mean Price per M^2[USD]",
        title="Mean House Price per M^2 by State"
    
    )
);

1.4.4 Create a scatter plotç”»æ•£ç‚¹å›¾
plt.scatter(x=df["area_m2"],y=df["price_usd"])
plt.xlabel("Area [sq meters]")
plt.ylabel("Price [USD]")
plt.title("Price vs Area");

1.4.5 corrè®¡ç®—ç›¸å…³ç³»æ•°ï¼Œè¶Šæ¥è¿‘1æ­£ç›¸å…³æ€§è¶Šå¼ºï¼Œè¶Šæ¥è¿‘-1è´Ÿç›¸å…³æ€§è¶Šå¼ºï¼Œè¶Šæ¥è¿‘0è¶Šæ²¡æœ‰ç›¸å…³æ€§
p_correlation = df["area_m2"].corr(df["price_usd"])
print(p_correlation)

1.4.6 Create a new DataFrame
df_morelos = df[df["state"]=="Morelos"]

1.4.7 æ ¹æ®æŒ‡æ ‡ç­›é€‰å¾—åˆ°æ–°çš„åˆ—è¡¨
df_south=df.loc[df["region"]=="South"]
é€‰å‡º"region"åˆ—ä¸­å€¼ä¸º"South"çš„æ‰€æœ‰æ•°æ®

1.4.8 é€‰å‡ºæˆ¿äº§æœ€å¤šçš„å·å¹¶æ ¹æ®è¯¥å·çš„æ•°æ®ç”»å›¾
# Subset data
df_south_rgs = df_south[df_south["state"]==(df_south["state"].value_counts().idxmax())]

# Build scatter plot
plt.scatter(x=df_south_rgs["area_m2"],y=df_south_rgs["price_usd"])


# Label axes
plt.xlabel("Area [sq meters]")
plt.ylabel("Price [USD]")

# Add title
plt.title("<name of state>: Price vs. Area")

# Don't change the code below ğŸ‘‡
plt.savefig("images/1-5-18.png", dpi=150)




